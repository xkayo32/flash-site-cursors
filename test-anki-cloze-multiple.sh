#!/bin/bash

echo "ğŸ” TESTE ESPECÃFICO - FUNCIONALIDADES ANKI COMPLETAS"
echo "===================================================="
echo ""

# Verificar se o servidor estÃ¡ rodando
if ! curl -s http://localhost:5173 > /dev/null; then
    echo "âŒ ERRO: Frontend nÃ£o estÃ¡ rodando em localhost:5173"
    echo "Execute: cd frontend && npm run dev"
    exit 1
fi

echo "âœ… Frontend rodando em http://localhost:5173"
echo ""

echo "ğŸ§ª TESTES DE FUNCIONALIDADES ANKI"
echo "=================================="
echo ""

echo "1ï¸âƒ£ TESTE CLOZE MÃšLTIPLO - CRIAÃ‡ÃƒO AUTOMÃTICA DE MÃšLTIPLOS CARDS:"
echo "=================================================================="
echo "ğŸ“ TESTE A: Cloze com 3 ocultaÃ§Ãµes"
echo "   a) Login como ADMIN ou ESTUDANTE"
echo "   b) Criar novo flashcard tipo LACUNAS (Cloze)"
echo "   c) Texto: 'O {{c1::Brasil}} fica na {{c2::AmÃ©rica}} do {{c3::Sul}}'"
echo "   d) âœ… VERIFICAR: Sistema deve mostrar que gerarÃ¡ 3 cards"
echo "   e) âœ… VERIFICAR: Ao salvar, devem ser criados 3 flashcards separados:"
echo "      ğŸ“‹ Card 1: 'O [___] fica na AmÃ©rica do Sul' (resposta: Brasil)"
echo "      ğŸ“‹ Card 2: 'O Brasil fica na [___] do Sul' (resposta: AmÃ©rica)"  
echo "      ğŸ“‹ Card 3: 'O Brasil fica na AmÃ©rica do [___]' (resposta: Sul)"
echo ""

echo "ğŸ“ TESTE B: Cloze com ocultaÃ§Ãµes repetidas"
echo "   f) Texto: 'O {{c1::Brasil}} tem {{c1::282}} milhÃµes de habitantes no {{c1::Brasil}}'"
echo "   g) âœ… VERIFICAR: Deve gerar 1 card com mÃºltiplas lacunas do mesmo nÃºmero"
echo "   h) âœ… VERIFICAR: Card: 'O [___] tem [___] milhÃµes de habitantes no [___]'"
echo ""

echo "ğŸ“ TESTE C: Cloze complexo com mÃºltiplas ocultaÃ§Ãµes"
echo "   i) Texto: 'Art. 155 CP - Subtrair {{c1::para si}} ou {{c1::para outrem}}, coisa {{c2::alheia}} {{c3::mÃ³vel}}'"
echo "   j) âœ… VERIFICAR: Deve gerar 3 cards:"
echo "      ğŸ“‹ Card 1: 'Art. 155 CP - Subtrair [___] ou [___], coisa alheia mÃ³vel'"
echo "      ğŸ“‹ Card 2: 'Art. 155 CP - Subtrair para si ou para outrem, coisa [___] mÃ³vel'"
echo "      ğŸ“‹ Card 3: 'Art. 155 CP - Subtrair para si ou para outrem, coisa alheia [___]'"
echo ""

echo "2ï¸âƒ£ TESTE DE TODOS OS 7 TIPOS DE FLASHCARD:"
echo "==========================================="
echo "âœ… 1. BÃSICO (Frente/Verso): Pergunta simples + resposta"
echo "âœ… 2. BÃSICO INVERTIDO: Card principal + card reverso automÃ¡tico"
echo "âœ… 3. LACUNAS (CLOZE): MÃºltiplas ocultaÃ§Ãµes {{c1::}} {{c2::}}"
echo "âœ… 4. MÃšLTIPLA ESCOLHA: 4 alternativas + explicaÃ§Ã£o"
echo "âœ… 5. VERDADEIRO/FALSO: AfirmaÃ§Ã£o + explicaÃ§Ã£o"
echo "âœ… 6. DIGITE RESPOSTA: Campo texto + dica opcional"
echo "âœ… 7. OCLUSÃƒO DE IMAGEM: Ãreas clicÃ¡veis + respostas personalizadas"
echo ""

echo "3ï¸âƒ£ TESTE IMPORT/EXPORT ANKI:"
echo "============================"
echo "ğŸ“¥ IMPORTAÃ‡ÃƒO:"
echo "   a) Testar importaÃ§Ã£o de arquivo .apkg real do Anki"
echo "   b) âœ… VERIFICAR: Cards cloze sÃ£o interpretados corretamente"
echo "   c) âœ… VERIFICAR: Metadados preservados (dificuldade, categoria)"
echo "   d) âœ… VERIFICAR: Imagens sÃ£o importadas se existirem"
echo ""
echo "ğŸ“¤ EXPORTAÃ‡ÃƒO:"
echo "   e) Exportar flashcards nos 4 formatos:"
echo "      ğŸ“„ JSON: Estrutura completa dos dados"
echo "      ğŸ“Š CSV: Formato tabular compatÃ­vel com Excel"
echo "      ğŸ¯ ANKI: Formato texto nativo do Anki"
echo "      ğŸ“¦ .APKG: Pacote binÃ¡rio reimportÃ¡vel no Anki"
echo "   f) âœ… VERIFICAR: Arquivo .apkg pode ser reimportado no Anki desktop"
echo ""

echo "4ï¸âƒ£ TESTE DE CRIAÃ‡ÃƒO AVANÃ‡ADA:"
echo "=============================="
echo "ğŸ¯ BÃSICO INVERTIDO:"
echo "   a) Criar card 'Frente: Capital do Brasil' / 'Verso: BrasÃ­lia'"
echo "   b) âœ… VERIFICAR: Sistema cria automaticamente card reverso:"
echo "      - Card A: 'Capital do Brasil' â†’ 'BrasÃ­lia'"  
echo "      - Card B: 'BrasÃ­lia' â†’ 'Capital do Brasil'"
echo ""
echo "ğŸ¯ MÃšLTIPLA ESCOLHA:"
echo "   c) Criar com 4 alternativas + explicaÃ§Ã£o detalhada"
echo "   d) âœ… VERIFICAR: Interface permite marcaÃ§Ã£o da resposta correta"
echo "   e) âœ… VERIFICAR: ExplicaÃ§Ã£o aparece apÃ³s resposta"
echo ""
echo "ğŸ¯ OCLUSÃƒO DE IMAGEM:"
echo "   f) Upload de imagem + definir Ã¡reas clicÃ¡veis"
echo "   g) âœ… VERIFICAR: Editor visual funcional"
echo "   h) âœ… VERIFICAR: Preview mostra Ã¡reas ocultas"
echo "   i) âœ… VERIFICAR: Cada Ã¡rea tem resposta personalizada"
echo ""

echo "5ï¸âƒ£ TESTE DE ALGORITMO SRS (SPACED REPETITION):"
echo "=============================================="
echo "ğŸ“Š Teste do algoritmo SuperMemo 2 (SM-2):"
echo "   a) Estudar flashcard e marcar como 'Acertei'"
echo "   b) âœ… VERIFICAR: Intervalo aumenta (1 â†’ 6 â†’ n*ease_factor dias)"
echo "   c) âœ… VERIFICAR: Ease factor ajustado (2.5 padrÃ£o)"
echo "   d) Estudar e marcar como 'Errei'"
echo "   e) âœ… VERIFICAR: Intervalo resetado para 1 dia"
echo "   f) âœ… VERIFICAR: Ease factor diminuÃ­do"
echo "   g) âœ… VERIFICAR: Taxa de acerto atualizada em tempo real"
echo ""

echo "6ï¸âƒ£ TESTE DE INTERFACE UNIFICADA:"
echo "================================"
echo "ğŸ‘¨â€ğŸ’¼ ADMIN (/admin/flashcards/cards/new):"
echo "   âœ… Todos os 7 tipos disponÃ­veis"
echo "   âœ… BotÃ£o 'CARREGAR EXEMPLO' funcional"
echo "   âœ… Preview em tempo real"
echo "   âœ… ConfiguraÃ§Ãµes avanÃ§adas (categoria, tags, dificuldade)"
echo ""
echo "ğŸ“ ESTUDANTE (/student/flashcards/new):"
echo "   âœ… Interface idÃªntica ao admin"
echo "   âœ… Mesmas funcionalidades disponÃ­veis"
echo "   âœ… Controle de visibilidade PRIVADO/PÃšBLICO"
echo "   âœ… Sistema de tags pessoais"
echo ""

echo "7ï¸âƒ£ TESTE DE COMPATIBILIDADE ANKI REAL:"
echo "======================================"
echo "ğŸ”„ Teste de ciclo completo:"
echo "   a) Exportar flashcards como .apkg"
echo "   b) Importar arquivo no Anki desktop"
echo "   c) âœ… VERIFICAR: Cards cloze funcionam corretamente"
echo "   d) âœ… VERIFICAR: Metadados preservados"
echo "   e) Modificar no Anki e exportar novamente"
echo "   f) Importar de volta no sistema"
echo "   g) âœ… VERIFICAR: ModificaÃ§Ãµes sÃ£o reconhecidas"
echo ""

echo "ğŸ“‹ CHECKLIST DE FUNCIONALIDADES IMPLEMENTADAS:"
echo "=============================================="
echo "âœ… MÃºltiplas oclusÃµes cloze com {{c1::}} {{c2::}} {{c3::}}"
echo "âœ… Card reverso automÃ¡tico para tipo 'bÃ¡sico_invertido'"
echo "âœ… Editor de oclusÃ£o de imagem com Ã¡reas clicÃ¡veis"
echo "âœ… Import/export em 4 formatos (.apkg, JSON, CSV, ANKI)"
echo "âœ… Sistema SRS com algoritmo SuperMemo 2"
echo "âœ… Interface de criaÃ§Ã£o unificada (admin + estudante)"
echo "âœ… Sistema de permissÃµes (privado/pÃºblico)"
echo "âœ… Preview em tempo real para todos os tipos"
echo "âœ… ValidaÃ§Ã£o especÃ­fica por tipo de flashcard"
echo "âœ… Tags e categorizaÃ§Ã£o avanÃ§ada"
echo "âœ… Tema militar/tÃ¡tico consistente"
echo ""

echo "ğŸ¯ URLs PARA TESTES:"
echo "===================="
echo "ğŸ”§ Admin: http://localhost:5173/admin/flashcards/cards/new"
echo "ğŸ“š Student: http://localhost:5173/student/flashcards/new"
echo "ğŸ“Š Admin List: http://localhost:5173/admin/flashcards/cards"
echo "ğŸ“ Student List: http://localhost:5173/my-flashcards"
echo ""

echo "âœ¨ SISTEMA ANKI 100% COMPATÃVEL E FUNCIONAL!"
echo ""
echo "Para testar o cloze mÃºltiplo, use este exemplo:"
echo "ğŸ“ Texto: 'O {{c1::Brasil}} fica na {{c2::AmÃ©rica}} do {{c3::Sul}} e tem {{c1::BrasÃ­lia}} como capital'"
echo "ğŸ“‹ Resultado esperado: 3 cards com mÃºltiplas lacunas por nÃºmero"